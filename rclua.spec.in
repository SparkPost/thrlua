Name: @PACKAGE_NAME@
Version: @PACKAGE_VERSION@
Release: 1%{?dist}
Group: Development/Libraries
Summary: A refcounted version of Lua, An Extensible Extension Language
License: MIT
URL: http://labs.omniti.com/rclua
Source0: %{name}-%{version}.tar.bz2
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-build-%(%{__id_u} -n)
BuildRequires: autoconf >= 2.50
BuildRequires: automake >= 1.4
BuildRequires: libtool >= 1.4.2
BuildRequires: gcc binutils make mktemp
# we (Message Systems) link against eclibedit, which doesn't provide
# libedit.so because it installs outside of the system library area.
# rpm generates a dep on libedit.so because the library we link against
# is named libedit.so, but rpm isn't smart enough to realize that we're
# smart enough to set the rpath.
# So, we turn off rpms auto dep stuff.
AutoReqProv: no
%if "%{EXTRA_RPM_DEPS}" != ""
Requires: %{EXTRA_RPM_DEPS}
%endif

%description
This is a version of the Lua embedded language modified to use
reference counting rather than garbage collection.

%prep
%setup -q

%build
%configure
%{__make}

%install
rm -rf %{buildroot}
%makeinstall

%if "%{_prefix}" == "/"
%postun
/sbin/ldconfig
%post
/sbin/ldconfig
%endif

%clean
rm -rf %{buildroot}

%files
%defattr(-,root,root,-)
%doc COPYING HISTORY INSTALL README
%{_bindir}/*
%{_libdir}/librclua.so.0
%{_libdir}/librclua.so.0.0.0
%{_mandir}/*/*
%dir %{_prefix}/lib/lua/@PACKAGE_VERMAJORMINOR@
%dir %{_prefix}/share/lua/@PACKAGE_VERMAJORMINOR@
%{_prefix}/share/lua/@PACKAGE_VERMAJORMINOR@/*

%package devel
Group: Development/Libraries
Summary: A refcounted version of Lua, An Extensible Extension Language
%description devel
Contains the libraries and header files for embedded rclua
into your own applications

%files devel
%defattr(-,root,root,-)
%{_includedir}/rclua/*.h
%{_includedir}/rclua/*.hpp
%{_libdir}/*.so
%{_libdir}/*.a
%{_libdir}/*.la



